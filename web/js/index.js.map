{"version":3,"file":"index.js","sources":["../src/debugString.ts"],"sourcesContent":["import { app } from '@comfyorg/comfyui-frontend/src/scripts/app';\r\nimport { ComfyWidgets } from '@comfyorg/comfyui-frontend/src/scripts/widgets';\r\nimport type { ComfyExtension } from '@comfyorg/comfyui-frontend/src/types/comfy';\r\n\r\nconst extension: ComfyExtension = {\r\n\tname: \"TypeScript-CustomNode.DebugString\",\r\n\tasync beforeRegisterNodeDef(nodeType, nodeData, app) {\r\n\t\tif (nodeData.name === \"DebugString\") {\r\n\t\t\tfunction debugString(content: string) {\r\n\t\t\t\tif (this.widgets) {\r\n\t\t\t\t\tfor (let i = 1; i < this.widgets.length; i++) {\r\n\t\t\t\t\t\tthis.widgets[i].onRemove?.();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.widgets.length = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst v = [...content];\r\n\t\t\t\tif (!v[0]) {\r\n\t\t\t\t\tv.shift();\r\n\t\t\t\t}\r\n\t\t\t\tfor (const list of v) {\r\n\t\t\t\t\tconst w = ComfyWidgets[\"STRING\"](this, \"text2\", [\"STRING\", { multiline: true }], app).widget;\r\n\t\t\t\t\tw.inputEl.readOnly = true;\r\n\t\t\t\t\tw.inputEl.style.opacity = 0.6;\r\n\t\t\t\t\tw.value = list;\r\n\t\t\t\t}\r\n\r\n\t\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\t\tconst sz = this.computeSize();\r\n\t\t\t\t\tif (sz[0] < this.size[0]) {\r\n\t\t\t\t\t\tsz[0] = this.size[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sz[1] < this.size[1]) {\r\n\t\t\t\t\t\tsz[1] = this.size[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.onResize?.(sz);\r\n\t\t\t\t\tapp.graph.setDirtyCanvas(true, false);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst onExecuted = nodeType.prototype.onExecuted;\r\n\t\t\tnodeType.prototype.onExecuted = function ({content}) {\r\n\t\t\t\tonExecuted?.apply(this, arguments);\r\n\t\t\t\tdebugString.call(this, content);\r\n\t\t\t};\r\n\r\n\t\t\tconst onConfigure = nodeType.prototype.onConfigure;\r\n\t\t\tnodeType.prototype.onConfigure = function () {\r\n\t\t\t\tonConfigure?.apply(this, arguments);\r\n\t\t\t\tif (this.widgets_values?.length) {\r\n\t\t\t\t\tdebugString.call(this, this.widgets_values.slice(+this.widgets_values.length > 1));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t},\r\n}\r\napp.registerExtension(extension);\r\n"],"names":["app"],"mappings":";;AAIA,MAAM,YAA4B;AAAA,EACjC,MAAM;AAAA,EACN,MAAM,sBAAsB,UAAU,UAAUA,MAAK;AAChD,QAAA,SAAS,SAAS,eAAe;AAC3B,UAAA,cAAT,SAAqB,SAAiB;AACrC,YAAI,KAAK,SAAS;AACjB,mBAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,QAAQ,KAAK;AACxC,iBAAA,QAAQ,CAAC,EAAE,WAAW;AAAA,UAAA;AAE5B,eAAK,QAAQ,SAAS;AAAA,QAAA;AAGjB,cAAA,IAAI,CAAC,GAAG,OAAO;AACjB,YAAA,CAAC,EAAE,CAAC,GAAG;AACV,YAAE,MAAM;AAAA,QAAA;AAET,mBAAW,QAAQ,GAAG;AACrB,gBAAM,IAAI,aAAa,QAAQ,EAAE,MAAM,SAAS,CAAC,UAAU,EAAE,WAAW,KAAM,CAAA,GAAGA,IAAG,EAAE;AACtF,YAAE,QAAQ,WAAW;AACnB,YAAA,QAAQ,MAAM,UAAU;AAC1B,YAAE,QAAQ;AAAA,QAAA;AAGX,8BAAsB,MAAM;AACrB,gBAAA,KAAK,KAAK,YAAY;AAC5B,cAAI,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,GAAG;AACzB,eAAG,CAAC,IAAI,KAAK,KAAK,CAAC;AAAA,UAAA;AAEpB,cAAI,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,GAAG;AACzB,eAAG,CAAC,IAAI,KAAK,KAAK,CAAC;AAAA,UAAA;AAEpB,eAAK,WAAW,EAAE;AAClBA,eAAI,MAAM,eAAe,MAAM,KAAK;AAAA,QAAA,CACpC;AAAA,MACF;AAEM,YAAA,aAAa,SAAS,UAAU;AACtC,eAAS,UAAU,aAAa,SAAU,EAAC,WAAU;AACxC,oBAAA,MAAM,MAAM,SAAS;AACrB,oBAAA,KAAK,MAAM,OAAO;AAAA,MAC/B;AAEM,YAAA,cAAc,SAAS,UAAU;AAC9B,eAAA,UAAU,cAAc,WAAY;AAC/B,qBAAA,MAAM,MAAM,SAAS;AAC9B,YAAA,KAAK,gBAAgB,QAAQ;AACpB,sBAAA,KAAK,MAAM,KAAK,eAAe,MAAM,CAAC,KAAK,eAAe,SAAS,CAAC,CAAC;AAAA,QAAA;AAAA,MAEnF;AAAA,IAAA;AAAA,EACD;AAEF;AACA,IAAI,kBAAkB,SAAS;"}