{"version":3,"file":"index.js","sources":["../src/debugString.ts"],"sourcesContent":["// Modified from https://github.com/pythongosssss/ComfyUI-Custom-Scripts/blob/main/web/js/showText.js\nimport { ComfyExtension } from '@comfyorg/comfyui-frontend-types'\nimport { LGraphNode } from '@comfyorg/litegraph';\n\nconst extension: ComfyExtension = {\n  name: \"TypeScript-CustomNode.DebugString\",\n  beforeRegisterNodeDef: async (nodeType, nodeData, app) => {\n    if (nodeData.name !== \"DebugString\") return;\n\n    const debugString = (node: LGraphNode, content: string) => {\n      if (!node.widgets) return;\n\n      node.widgets.slice(1).forEach(widget => widget.onRemove?.());\n      node.widgets.length = 1;\n\n      const values = content ? [...content] : [];\n      console.log(values);\n\n      values.forEach(list => {\n        const inputName = \"content2\" // MUST NOT be same as the original widget input name.\n        node.addWidget('STRING', inputName, list, () => { }, [\"STRING\", { inputEl: { readOnly: true, style: { opacity: 0.6 } }, multiline: true }])\n      });\n\n      requestAnimationFrame(() => {\n        if (!node.size) return;\n        const sz = node.computeSize();\n        sz[0] = Math.max(sz[0], node.size[0]);\n        sz[1] = Math.max(sz[1], node.size[1]);\n        node.onResize?.(sz);\n        app.graph.setDirtyCanvas(true, false);\n      });\n    };\n\n    const originalOnExecuted = nodeType.prototype.onExecuted;\n    nodeType.prototype.onExecuted = function (message) {\n      originalOnExecuted?.apply(this, arguments);\n      debugString(this, message.content);\n    };\n\n    const originalOnConfigure = nodeType.prototype.onConfigure;\n    nodeType.prototype.onConfigure = function () {\n      originalOnConfigure?.apply(this, arguments);\n      // this.widgets_values is an array of input values\n      debugString(this, this.widgets_values[0] as string);\n    };\n  },\n};\n\napp.registerExtension(extension);\n"],"names":["app"],"mappings":";AAIA,MAAM,YAA4B;AAAA,EAChC,MAAM;AAAA,EACN,uBAAuB,OAAO,UAAU,UAAUA,SAAQ;AACpD,QAAA,SAAS,SAAS,cAAe;AAE/B,UAAA,cAAc,CAAC,MAAkB,YAAoB;AACrD,UAAA,CAAC,KAAK,QAAS;AAEd,WAAA,QAAQ,MAAM,CAAC,EAAE,QAAQ,CAAU,WAAA,OAAO,YAAY;AAC3D,WAAK,QAAQ,SAAS;AAEtB,YAAM,SAAS,UAAU,CAAC,GAAG,OAAO,IAAI,CAAC;AACzC,cAAQ,IAAI,MAAM;AAElB,aAAO,QAAQ,CAAQ,SAAA;AACrB,cAAM,YAAY;AAClB,aAAK,UAAU,UAAU,WAAW,MAAM,MAAM;AAAA,WAAK,CAAC,UAAU,EAAE,SAAS,EAAE,UAAU,MAAM,OAAO,EAAE,SAAS,IAAI,EAAA,GAAK,WAAW,KAAM,CAAA,CAAC;AAAA,MAAA,CAC3I;AAED,4BAAsB,MAAM;AACtB,YAAA,CAAC,KAAK,KAAM;AACV,cAAA,KAAK,KAAK,YAAY;AACzB,WAAA,CAAC,IAAI,KAAK,IAAI,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,CAAC;AACjC,WAAA,CAAC,IAAI,KAAK,IAAI,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,CAAC;AACpC,aAAK,WAAW,EAAE;AAClBA,aAAI,MAAM,eAAe,MAAM,KAAK;AAAA,MAAA,CACrC;AAAA,IACH;AAEM,UAAA,qBAAqB,SAAS,UAAU;AACrC,aAAA,UAAU,aAAa,SAAU,SAAS;AAC7B,0BAAA,MAAM,MAAM,SAAS;AAC7B,kBAAA,MAAM,QAAQ,OAAO;AAAA,IACnC;AAEM,UAAA,sBAAsB,SAAS,UAAU;AACtC,aAAA,UAAU,cAAc,WAAY;AACtB,2BAAA,MAAM,MAAM,SAAS;AAE1C,kBAAY,MAAM,KAAK,eAAe,CAAC,CAAW;AAAA,IACpD;AAAA,EAAA;AAEJ;AAEA,IAAI,kBAAkB,SAAS;"}